function initMap(){map=new google.maps.Map(document.getElementById("map"),{zoom:13,center:{lat:37.557777,lng:-77.478691}}),ko.applyBindings(new ViewModel)}function googleMapsLoadError(){alert("There was an error occurred while loading Google Maps. Please refresh the page and try again.")}function ViewModel(){var e=makeMarkerIcon("FF6347"),t=makeMarkerIcon("0091FF"),o=this;this.searchItem=ko.observable(""),this.markerList=[],this.locationInfoDisplay=function(e,t){if(t.marker!=e){t.setContent(""),t.marker=e;var n="https://api.foursquare.com/v2/venues/search?ll="+e.lat+","+e.lng+"&client_id=OUFWP44SIIVPYHWTHMNRMUIBJMLS1WPPTVMHRRWKMOQ15NRJ&client_secret=K5X2B24TUUIKWR0VW0GPD1PHQBOVQ2YDF4OVZZ4XVLDO1DEZ&query="+e.title+"&v=20170708&m=foursquare";$.getJSON(n).done(function(e){var n=e.response.venues[0];o.street=n.location.formattedAddress[0],o.city=n.location.formattedAddress[1],o.zip=n.location.formattedAddress[3],o.category=n.categories[0].shortName,o.displayDetails='<h5 class="category"> ('+o.category+') </h5><h6 class="address-heading"> Address: </h6><p class="address">'+o.street+'</p><p class="address">'+o.city+'</p><div id="content"></div>',t.setContent(o.infoWindowContent+o.displayDetails)}).fail(function(){alert("Issue loading Foursquare API. Please refresh your page and try again.")}),this.infoWindowContent='<div><h4 class="location-name">'+e.title+"</h4>",t.open(map,e);var i=null;google.maps.event.addListener(t,"domready",function(){null!=i&&(i.unbind("position"),i.setVisible(!1)),(i=new google.maps.StreetViewPanorama(document.getElementById("content"),{navigationControl:!0,newavigationControlOptions:{style:google.maps.NavigationControlStyle.ANDROID},enableCloseButton:!1,addressControl:!1,linksControl:!1})).bindTo("position",e),i.setVisible(!0)}),google.maps.event.addListener(t,"closeclick",function(){i.unbind("position"),i.setVisible(!1),i=null}),google.maps.event.addListener(map,"click",function(){t.close()})}},this.makeMarkerBounce=function(){o.locationInfoDisplay(this,o.infoWindow),this.setAnimation(google.maps.Animation.BOUNCE),this.setIcon(t),setTimeout(function(){this.setAnimation(null)}.bind(this),1400)},this.infoWindow=new google.maps.InfoWindow({content:'<div id="content" style="width:200px;height:200px;"></div>'});for(var n=0;n<richmondLocations.length;n++)o.locationTitle=richmondLocations[n].title,o.locationLat=richmondLocations[n].lat,o.locationLng=richmondLocations[n].lng,o.marker=new google.maps.Marker({map:map,position:{lat:o.locationLat,lng:o.locationLng},title:o.locationTitle,lat:o.locationLat,lng:o.locationLng,animation:google.maps.Animation.DROP,icon:e}),this.marker.setMap(map),this.markerList.push(this.marker),this.marker.addListener("click",o.makeMarkerBounce),this.marker.addListener("mouseout",function(){this.setIcon(e)});this.myLocations=ko.computed(function(){for(var e=[],t=0;t<this.markerList.length;t++){var o=this.markerList[t];o.title.toLowerCase().includes(this.searchItem().toLowerCase())?(e.push(o),this.markerList[t].setVisible(!0)):this.markerList[t].setVisible(!1)}return e},this)}function makeMarkerIcon(e){return new google.maps.MarkerImage("http://chart.googleapis.com/chart?chst=d_map_spin&chld=1.15|0|"+e+"|40|_|%E2%80%A2",new google.maps.Size(21,34),new google.maps.Point(0,0),new google.maps.Point(10,34),new google.maps.Size(21,34))}$(document).ready(function(){function e(){windowHeight=$(window).innerHeight(),$("#map").css("min-height",windowHeight),$("#sidebar").css("min-height",windowHeight)}e(),$(window).resize(function(){e()})});var map;