function initMap(){map=new google.maps.Map(document.getElementById("map"),{zoom:13,center:{lat:37.557777,lng:-77.478691}}),ko.applyBindings(new ViewModel)}function googleMapsLoadError(){alert("There was an error occurred while loading Google Maps. Please refresh the page and try again.")}function ViewModel(){var e="OUFWP44SIIVPYHWTHMNRMUIBJMLS1WPPTVMHRRWKMOQ15NRJ",t="K5X2B24TUUIKWR0VW0GPD1PHQBOVQ2YDF4OVZZ4XVLDO1DEZ",o=makeMarkerIcon("FF6347"),n=makeMarkerIcon("0091FF"),i='<div id="content" style="width:200px;height:200px;"></div>',a=this;this.searchItem=ko.observable(""),this.markerList=[],this.locationInfoDisplay=function(o,n){if(n.marker!=o){n.setContent(""),n.marker=o;var i="https://api.foursquare.com/v2/venues/search?ll="+o.lat+","+o.lng+"&client_id="+e+"&client_secret="+t+"&query="+o.title+"&v=20170708&m=foursquare";$.getJSON(i).done(function(e){var t=e.response.venues[0];a.street=t.location.formattedAddress[0],a.city=t.location.formattedAddress[1],a.zip=t.location.formattedAddress[3],a.category=t.categories[0].shortName,a.displayDetails='<h5 class="category"> ('+a.category+') </h5><h6 class="address-heading"> Address: </h6><p class="address">'+a.street+'</p><p class="address">'+a.city+'</p><div id="content"></div>',n.setContent(a.infoWindowContent+a.displayDetails)}).fail(function(){alert("Issue loading Foursquare API. Please refresh your page and try again.")}),this.infoWindowContent='<div><h4 class="location-name">'+o.title+"</h4>",n.open(map,o);var s=null;google.maps.event.addListener(n,"domready",function(){null!==s&&(s.unbind("position"),s.setVisible(!1)),s=new google.maps.StreetViewPanorama(document.getElementById("content"),{navigationControl:!0,newavigationControlOptions:{style:google.maps.NavigationControlStyle.ANDROID},enableCloseButton:!1,addressControl:!1,linksControl:!1}),s.bindTo("position",o),s.setVisible(!0)}),google.maps.event.addListener(n,"closeclick",function(){s.unbind("position"),s.setVisible(!1),s=null}),google.maps.event.addListener(map,"click",function(){n.close()})}},this.makeMarkerBounce=function(){a.locationInfoDisplay(this,a.infoWindow),this.setAnimation(google.maps.Animation.BOUNCE),this.setIcon(n),setTimeout(function(){this.setAnimation(null)}.bind(this),1400)};var s=function(){this.setIcon(o)};this.infoWindow=new google.maps.InfoWindow({content:i});for(var r=0;r<richmondLocations.length;r++)a.locationTitle=richmondLocations[r].title,a.locationLat=richmondLocations[r].lat,a.locationLng=richmondLocations[r].lng,a.marker=new google.maps.Marker({map:map,position:{lat:a.locationLat,lng:a.locationLng},title:a.locationTitle,lat:a.locationLat,lng:a.locationLng,animation:google.maps.Animation.DROP,icon:o}),this.marker.setMap(map),this.markerList.push(this.marker),this.marker.addListener("click",a.makeMarkerBounce),this.marker.addListener("mouseout",s);this.myLocations=ko.computed(function(){for(var e=[],t=0;t<this.markerList.length;t++){var o=this.markerList[t];o.title.toLowerCase().includes(this.searchItem().toLowerCase())?(e.push(o),this.markerList[t].setVisible(!0)):this.markerList[t].setVisible(!1)}return e},this)}function makeMarkerIcon(e){var t=new google.maps.MarkerImage("http://chart.googleapis.com/chart?chst=d_map_spin&chld=1.15|0|"+e+"|40|_|%E2%80%A2",new google.maps.Size(21,34),new google.maps.Point(0,0),new google.maps.Point(10,34),new google.maps.Size(21,34));return t}$(document).ready(function(){function e(){windowHeight=$(window).innerHeight(),$("#map").css("min-height",windowHeight),$("#sidebar").css("min-height",windowHeight)}e(),$(window).resize(function(){e()})});var map;
